<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- CoreUI CSS -->
    <link rel="stylesheet" href="https://unpkg.com/@coreui/coreui/dist/css/coreui.min.css" crossorigin="anonymous">
    <title>유한누리 상담사 페이지</title>
	<script src="https://code.jquery.com/jquery-latest.min.js"></script>
	<link rel="stylesheet" href="https://unpkg.com/@coreui/icons@2.0.0-beta.3/css/all.min.css">
	<style>
		.fixed_save_btn{
			position: fixed;
			top: 20%;
			left: 80%;
			z-index:999;
		}
		.pr_10{
			padding-right:10px;
		}
		.pr_30{
			padding-right:30px;
		}
		.tox-tinymce-aux{
			width:0px !important;
		}
	</style>
</head>
<body class="c-app">
	<script>
		$('#add_type_button').click(function(e){
			$.ajax({
				type:'POST',
				dataType:'json',
				url:'../addType',
				async:true,
				data:{"add_type" : $('#type-name').val()},
				success:function(data){
					window.location.reload();
				}
			})
		});
	</script>
	<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		  <div class="modal-dialog" role="document">
			<div class="modal-content">
			  <div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">항목 추가</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
				  <span aria-hidden="true">&times;</span>
				</button>
			  </div>
			  <div class="modal-body">
				<form>
				  <div class="form-group">
					<label for="type-name" class="col-form-label">항목 이름:</label>
					<input type="text" class="form-control" id="type-name" placeholder="항목이름을 작성해주세요.">
				  </div>
				</form>
			  </div>
			  <div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
				<button type="button" class="btn btn-primary" id="add_type_button">추가하기</button>
			  </div>
			</div>
		  </div>
		</div>
    <div class="c-sidebar c-sidebar-dark c-sidebar-fixed c-sidebar-lg-show" id="sidebar">
         <%- include ('adminNav'); -%>
        <button class="c-sidebar-minimizer c-class-toggler" type="button" data-target="_parent"
            data-class="c-sidebar-minimized"></button>
    </div>
    <div class="c-wrapper c-fixed-components">
        <header class="c-header c-header-light c-header-fixed c-header-with-subheader">
            <button class="c-header-toggler c-class-toggler d-lg-none mfe-auto" type="button" data-target="#sidebar"
                data-class="c-sidebar-show">
                <i class="cil-hamburger-menu"></i>
            </button><a class="c-header-brand d-lg-none" href="#">
                <i class="cil-hamburger-menu"></i></a>
            <button class="c-header-toggler c-class-toggler mfs-3 d-md-down-none" type="button" data-target="#sidebar"
                data-class="c-sidebar-lg-show" responsive="true">
                <i class="cil-hamburger-menu"></i>
            </button>
            <ul class="c-header-nav ml-auto mr-4">
                <%- include ('adminAccount'); -%>
            </ul>
            <div class="c-subheader px-3">
                <!-- Breadcrumb-->
                <ol class="breadcrumb border-0 m-0">
                    <li class="breadcrumb-item">예약</li>
                    <li class="breadcrumb-item">양식 항목</li>
                    <li class="breadcrumb-item active"><%=type[1]%></li>
                    <!-- Breadcrumb Menu-->
                </ol>
            </div>
        </header>
		
        <div class="c-body">
            <main class="c-main">
                <div class="container-fluid">
                    <div class="fade-in">
                        <div class="card">
                            <div class="card-body">
								<textarea class="tinymce" id="textEditor"></textarea>
                            </div>
                        </div>
                    </div>
					
                </div>
            </main>
            <footer class="c-footer">
                <div><a href="https://coreui.io">CoreUI</a> &copy; 2020 creativeLabs.</div>
                <div class="ml-auto">Powered by&nbsp;<a href="https://coreui.io/">CoreUI</a></div>
            </footer>
        </div>
		
    </div>
	<script src="/lib/tinymce_5.6.1/tinymce/js/tinymce/tinymce.min.js"></script>
	<script>
		tinymce.init({
			selector: "textarea.tinymce",
			
			language:"ko_KR",

			height: 800,

			statubar: true,

			plugins: [
				"advlist autolink link lists charmap print preview hr anchor pagebreak",
				"searchreplace visualblocks visualchars fullscreen insertdatetime nonbreaking",
				"table contextmenu directionality emoticons paste textcolor save image"
			],

			/* toolbar */
			toolbar: "undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link | print preview  fullpage | forecolor backcolor emoticons save image",
			
			
			images_upload_url: '/admin/uploadFile',
			
			/* style */
			style_formats: [
				{title: "Headers", items: [
					{title: "Header 1", format: "h1"},
					{title: "Header 2", format: "h2"},
					{title: "Header 3", format: "h3"},
					{title: "Header 4", format: "h4"},
					{title: "Header 5", format: "h5"},
					{title: "Header 6", format: "h6"}
				]},
				{title: "Inline", items: [
					{title: "Bold", icon: "bold", format: "bold"},
					{title: "Italic", icon: "italic", format: "italic"},
					{title: "Underline", icon: "underline", format: "underline"},
					{title: "Strikethrough", icon: "strikethrough", format: "strikethrough"},
					{title: "Superscript", icon: "superscript", format: "superscript"},
					{title: "Subscript", icon: "subscript", format: "subscript"},
				]},
				{title: "Blocks", items: [
					{title: "Paragraph", format: "p"},
					{title: "Blockquote", format: "blockquote"},
					{title: "Div", format: "div"},
					{title: "Pre", format: "pre"}
				]},
				{title: "Alignment", items: [
					{title: "Left", icon: "alignleft", format: "alignleft"},
					{title: "Center", icon: "aligncenter", format: "aligncenter"},
					{title: "Right", icon: "alignright", format: "alignright"},
					{title: "Justify", icon: "alignjustify", format: "alignjustify"}
				]}
			],
			init_instance_callback : function(editor) {
    			editor.setContent(`<%-result%>`);
  			},
			save_onsavecallback: function () {
				let content=tinymce.get("textEditor").getContent();
				$.ajax({
					type: "POST",
					dataType: "json",
					url: '../saveBoard/<%=type[0]%>',
					async: true,
					data: { "sendAjax" : content },
					success: function (data) { 
						if (data.state === 'ok') {
							$('.c-main').prepend(`<div class="alert alert-success alert-dismissible fade show successAlert" role="alert">
							  <strong>저장 완료!</strong> 게시물이 정상적으로 저장되었습니다.
							  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							  </button>
							</div>`);

							$(window).scrollTop(0);

							$('.successAlert').eq(0).fadeOut(3000);
						}else{
							$('.c-main').prepend(`<div class="alert alert-danger alert-dismissible fade show failAlert" role="alert">
							  <strong>저장 실패!</strong> 다시 한번 확인해 주세요.
							  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							  </button>
							</div>`);

							$(window).scrollTop(0);

							$('.failAlert').eq(0).fadeOut(3000);
						}
					}
				});
			}
		});
	</script>
	<script src="https://unpkg.com/@coreui/coreui/dist/js/coreui.bundle.min.js"></script>
</body>

</html>

